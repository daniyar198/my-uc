<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____837418072']= array(base64_decode(''.'aXNfc3'.'R'.'yaW5'.'n'),base64_decode('c3Ry'.'dG9sb3dlcg=='),base64_decode('aX'.'NfYXJyYXk='),base64_decode(''.'a'.'XNfc3'.'RyaW5n'),base64_decode('Z'.'3pkZW'.'NvZGU='),base64_decode(''.'Y'.'mFzZ'.'TY0X2Rl'.'Y29kZQ='.'='),base64_decode('dX'.'Js'.'ZGVjb2R'.'l'),base64_decode('YX'.'JyY'.'XlfcmV2ZXJz'.'ZQ'.'=='),base64_decode('Z3'.'plbmNvZGU='),base64_decode('Y'.'mFzZTY0'.'X2VuY29kZ'.'Q'.'=='),base64_decode('dXJsZ'.'W5jb2Rl'),base64_decode(''.'Ym'.'luMm'.'hle'.'A'.'=='),base64_decode('aX'.'NfY'.'XJyY'.'Xk='),base64_decode('c3'.'Ry'.'dG'.'9sb3'.'dlcg=='),base64_decode(''.'aXNfYXJyYXk='),base64_decode('am9pbg'.'=='),base64_decode(''.'Zm5'.'tY'.'XRja'.'A=='),base64_decode('cmF3dX'.'JsZ'.'GVjb2Rl'),base64_decode('c3V'.'ic3Ry'),base64_decode('c3Vic3R'.'y'),base64_decode(''.'c3Ry'.'X3'.'JlcGxhY2U'.'='),base64_decode('cH'.'JlZ1'.'9xdW'.'90ZQ=='),base64_decode('cHJ'.'lZ19'.'tYXRjaA'.'=='));if(!function_exists(__NAMESPACE__.'\\___1664509368')){function ___1664509368($_392428813){static $_1450486294= false; if($_1450486294 == false) $_1450486294=array('YWN0aW9u','aW50'.'dm'.'Fs','cG'.'F'.'0aA==','Y29'.'udGV4dA'.'==',''.'a2'.'V5cw==','cHJ'.'vY2'.'Vz'.'cw==','ZW'.'5jb'.'2Rpbmc=','cHJ'.'lZ1'.'9yZXBsYW'.'Nl','cGF0'.'aA==','Y'.'29udGV4dA='.'=','a2V5'.'cw==','cHJ'.'vY2Vz'.'cw'.'==','ZW'.'5j'.'b2Rpb'.'mc=','cGF0dGVybg'.'==','cHJlZ19tY'.'XRjaA==',''.'c'.'GF'.'0'.'aA'.'='.'=','Y29udGV'.'4dA='.'=','a2V5cw==','cH'.'J'.'vY2Vz'.'c'.'w'.'==','Z'.'W5jb2Rpb'.'mc=','cGF0'.'dGVy'.'bg='.'=','cG9zdF9'.'hY3Rp'.'b24'.'=','Y2hlY'.'2tfY3NyZg'.'==','cGF0aA='.'=',''.'Y29ud'.'GV4'.'dA==','a2V5cw==','cHJv'.'Y'.'2Vzcw==','Z'.'W'.'5'.'jb'.'2Rpb'.'mc=','cGF0dGVybg==','YWN0aW9u','YWN0aW9u','YWN0aW'.'9u','YWN0a'.'W'.'9'.'u','YWN0aW9'.'u',''.'YWN0'.'aW9u','cG'.'9zdF9hY3R'.'pb24=',''.'ZW5jb2Rpbmc=','ZW5jb2Rpbmc=','Z'.'W5jb2Rpbmc=','ZW'.'5jb2Rp'.'b'.'mc=','ZW5jb2Rpbmc=','Z'.'W5jb2Rpbmc=','Z3o'.'=','YmFz'.'ZTY'.'0',''.'dXJs','aGV4','L'.'g==','L'.'w==','aW5kZ'.'X'.'gucGhw','L2luZG'.'V'.'4LnBocA='.'=',''.'U0NS'.'SV'.'B'.'UX05B'.'TUU=',''.'L2luZGV4Ln'.'BocA==',''.'U0NS'.'SVBUX05BTUU=','U0NSSVBUX05BTUU=','U'.'0NSSVB'.'UX05BTUU=','fg==','fl4=','fg'.'='.'=',''.'XH4=','JH4=');return base64_decode($_1450486294[$_392428813]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1601224851; protected $_1118983616; protected $_264169836; protected $_131977677; protected $_1184644391; public static function make(array $_1247005238):?static{ $_1247005238= static::prepareRuleParameters($_1247005238); return match($_1247005238[___1664509368(0)]){ ___1664509368(1) => new IntvalRule( $_1247005238[___1664509368(2)], $_1247005238[___1664509368(3)], $_1247005238[___1664509368(4)], $_1247005238[___1664509368(5)], $_1247005238[___1664509368(6)]), ___1664509368(7) => new PregReplaceRule( $_1247005238[___1664509368(8)], $_1247005238[___1664509368(9)], $_1247005238[___1664509368(10)], $_1247005238[___1664509368(11)], $_1247005238[___1664509368(12)], $_1247005238[___1664509368(13)]), ___1664509368(14) => new PregMatchRule( $_1247005238[___1664509368(15)], $_1247005238[___1664509368(16)], $_1247005238[___1664509368(17)], $_1247005238[___1664509368(18)], $_1247005238[___1664509368(19)], $_1247005238[___1664509368(20)], $_1247005238[___1664509368(21)]), ___1664509368(22) => new CsrfRule( $_1247005238[___1664509368(23)], $_1247005238[___1664509368(24)], $_1247005238[___1664509368(25)], $_1247005238[___1664509368(26)], $_1247005238[___1664509368(27)], $_1247005238[___1664509368(28)],), default => null,};} protected static function prepareRuleParameters(array $_955571947): array{ if($GLOBALS['____837418072'][0]($_955571947[___1664509368(29)])){ $_955571947[___1664509368(30)]= $GLOBALS['____837418072'][1]($_955571947[___1664509368(31)]);} elseif($GLOBALS['____837418072'][2]($_955571947[___1664509368(32)])){ $_1464862414= $_955571947[___1664509368(33)]; $_955571947[___1664509368(34)]= $_1464862414[min(184,0,61.333333333333)]; $_955571947[___1664509368(35)]= $_1464862414[round(0+0.2+0.2+0.2+0.2+0.2)];} $_955571947[___1664509368(36)]=!empty($_955571947[___1664509368(37)])? $_955571947[___1664509368(38)]:[]; if($GLOBALS['____837418072'][3]($_955571947[___1664509368(39)])){ $_955571947[___1664509368(40)]=[$_955571947[___1664509368(41)]];} return $_955571947;}  public function __construct($_1601224851, $_1118983616, $_264169836, $_131977677, $_1184644391){ $this->_1601224851= $_1601224851; $this->_1118983616= $this->castContext($_1118983616); $this->_264169836= $this->castKeys($_264169836); $this->_131977677= $_131977677; $this->_1184644391= $_1184644391;} public function evaluateValue($_2006841348){ if(!empty($this->_1184644391)){ foreach($this->_1184644391 as $_502540062){ $_2006841348= match($_502540062){ 'gz' => $GLOBALS['____837418072'][4]($_2006841348), 'base64' => $GLOBALS['____837418072'][5]($_2006841348), 'url' => $GLOBALS['____837418072'][6]($_2006841348), 'hex' => hex2bin($_2006841348)};}} $_281332288= $this->evaluate($_2006841348); if(!empty($this->_1184644391) && $_281332288 instanceof ModifyResult){ $_184529870= $_281332288->getCleanValue(); foreach($GLOBALS['____837418072'][7]($this->_1184644391) as $_502540062){ $_184529870= match($_502540062){ ___1664509368(42) => $GLOBALS['____837418072'][8]($_184529870), ___1664509368(43) => $GLOBALS['____837418072'][9]($_184529870), ___1664509368(44) => $GLOBALS['____837418072'][10]($_184529870), ___1664509368(45) => $GLOBALS['____837418072'][11]($_184529870)};} $_281332288= new ModifyResult($_184529870);} return $_281332288;} abstract public function evaluate($_2006841348); protected function castContext($_1118983616){ if(!$GLOBALS['____837418072'][12]($_1118983616)){ $_1118983616=[$_1118983616];} foreach($_1118983616 as $_28554363 => $_200386521){ $_1118983616[$_28554363]= $GLOBALS['____837418072'][13]($_200386521);} return $_1118983616;} protected function castKeys($_264169836){ if(!$GLOBALS['____837418072'][14]($_264169836)){ $_264169836=[$_264169836];} return $_264169836;} public function matchKey(array $_297925293): bool{ $_297925293= $GLOBALS['____837418072'][15](___1664509368(46), $_297925293); foreach($this->_264169836 as $_997119937){   if($GLOBALS['____837418072'][16]($_997119937, $_297925293)){ return true;}} return false;}  public function matchPath($_1775379663){ if($this->_1601224851 === '*'){ return true;}  $_1987085452= new Uri($_1775379663); $_557354591= $_1987085452->getPath(); $_557354591= $GLOBALS['____837418072'][17]($_557354591);      if(str_ends_with($_557354591, ___1664509368(47))){ $_557354591 .= ___1664509368(48);} $_557354591= Path::normalize($_557354591);  $_577056977[]= $_557354591; if(str_ends_with($_557354591, ___1664509368(49))){ $_577056977[]= $GLOBALS['____837418072'][18]($_557354591,(158*2-316),-round(0+1.8+1.8+1.8+1.8+1.8));} elseif(str_ends_with($_SERVER[___1664509368(50)], ___1664509368(51))){ $_577056977[]= $GLOBALS['____837418072'][19]($_SERVER[___1664509368(52)],(233*2-466),-round(0+2.25+2.25+2.25+2.25));} if($_557354591 !== $_SERVER[___1664509368(53)]){ $_577056977[]= $_SERVER[___1664509368(54)];}  if(str_starts_with($this->_1601224851, ___1664509368(55))){ $_430660585= $this->_1601224851;} else{ $_430660585= ___1664509368(56). $GLOBALS['____837418072'][20](___1664509368(57), ___1664509368(58), $GLOBALS['____837418072'][21]($this->_1601224851)). ___1664509368(59);} foreach($_577056977 as $_523835388){ if($this->_1601224851 === $_523835388 || $GLOBALS['____837418072'][22]($_430660585, $_523835388)){ return true;}} return false;}  public function getPath(){ return $this->_1601224851;}  public function getContext(){ return $this->_1118983616;}  public function getKeys(){ return $this->_264169836;}  public function getProcess(){ return $this->_131977677;}}?>